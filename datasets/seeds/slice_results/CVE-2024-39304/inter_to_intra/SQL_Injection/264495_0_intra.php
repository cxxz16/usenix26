<?php
function VolunteerOpportunityEditor($sAction)
{
    $iOpp = -1;
    if (array_key_exists('Opp', $_GET)) {
        $iOpp = legacyFilterInput($_GET['Opp'], 'int');
    }
    if (($sAction == 'delete') && $iOpp > 0) {
        $sSQL = "SELECT * FROM `volunteeropportunity_vol` WHERE `vol_ID` = '" . $iOpp . "'";
        $rsOpps = RunQuery($sSQL);
        $aRow = mysqli_fetch_array($rsOpps);
        extract($aRow);
        $sSQL .= "WHERE `p2vo_vol_ID` = '" . $iOpp . "' ";
        $sSQL .= 'ORDER BY `per_LastName`, `per_FirstName` ';
        $rsPeople = RunQuery($sSQL);
        $numRows = mysqli_num_rows($rsPeople);
        if ($numRows > 0) {
            for ($i = 0; $i < $numRows; $i++) {
                $aRow = mysqli_fetch_array($rsPeople);
                extract($aRow);
            }
        }
        echo "\n<br><a class='btn btn-danger' href=\"VolunteerOpportunityEditor.php?act=ConfDelete&amp;Opp=" . $iOpp . '"> ';
    }
    if (($sAction == 'ConfDelete') && $iOpp > 0) {
        $sSQL = "SELECT vol_Order from volunteeropportunity_vol WHERE vol_ID='$iOpp'";
        $rsOrder = RunQuery($sSQL);
        $aRow = mysqli_fetch_array($rsOrder);
        $orderVal = $aRow[0];
        $sSQL = "DELETE FROM `volunteeropportunity_vol` WHERE `vol_ID` = '" . $iOpp . "'";
        RunQuery($sSQL);
        $sSQL = "DELETE FROM `person2volunteeropp_p2vo` WHERE `p2vo_vol_ID` = '" . $iOpp . "'";
        RunQuery($sSQL);
    }
}
?>