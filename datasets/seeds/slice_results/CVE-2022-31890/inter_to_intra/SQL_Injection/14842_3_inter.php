<?php
class AuditEntry {
    static function getPageNav() {
        // Merged logic from getQwhere and getPageNav with cross-function actual arguments inlined
        $objectId = 'AuditEntry';
        $hide_views = false;
        $type = '';
        $qwhere = '';
        $class = $objectId;

        switch ($class) {
            case 'AuditEntry':
                $qwhere .= ' AND object_type=' . db_input($_REQUEST['type'] ?: 'D');
                if ($hide_views) {
                    $qwhere .= ' AND event_id=' . db_input(Event::getIdByName($_REQUEST['state']));
                }
                if ($_REQUEST['state'] && $_REQUEST['state'] != __('All')) {
                    $qwhere .= ' AND event_id=' . db_input($event_id);
                }
                if (($startTime && $startTime > time()) or ($startTime > $endTime && $endTime > 0)) {
                } else {
                    if ($startTime) {
                        $qwhere .= ' AND timestamp>=FROM_UNIXTIME(' . $startTime . ')';
                    }
                    if ($endTime) {
                        $qwhere .= ' AND timestamp<=FROM_UNIXTIME(' . $endTime . ')';
                    }
                }
                break;
            default:
                break;
        }

        if (!self::$show_view_audits) {
            $qwhere .= ' AND event_id !=' . db_input(Event::getIdByName('viewed'));
        }

        // Keep function calls to listed source/sink as-is (e.g., Event::getIdByName). 
        // db_count is called as in original getPageNav
        $total = db_count("SELECT count(*) $qfrom $qwhere");
        return $total;
    }
}
?>