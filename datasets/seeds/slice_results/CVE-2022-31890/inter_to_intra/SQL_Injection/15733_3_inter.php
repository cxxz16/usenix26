<?php
function getTableInfo($objectId, $export=false, $type='') {
    $qwhere = '';
    $hide_views = false;
    $class = 'AuditEntry';

    switch ($class) {
        case 'AuditEntry':
            $qwhere .= ' AND object_type=' . db_input($_REQUEST['type'] ?: 'D');
            if ($hide_views) {
                $qwhere .= ' AND event_id=' . db_input(Event::getIdByName($_REQUEST['state']));
            }
            if ($_REQUEST['state'] && $_REQUEST['state'] != __('All')) {
                $event_id = Event::getIdByName(lcfirst($_REQUEST['state']));
                $qwhere .= ' AND event_id=' . db_input($event_id);
            }
            $startTime = ($_REQUEST['startDate'] && (strlen($_REQUEST['startDate']) >= 8)) ? strtotime($_REQUEST['startDate']) : 0;
            $endTime = ($_REQUEST['endDate'] && (strlen($_REQUEST['endDate']) >= 8)) ? strtotime($_REQUEST['endDate']) : 0;
            if (($startTime && $startTime > time()) or ($startTime > $endTime && $endTime > 0)) {
            } else {
                if ($startTime)
                    $qwhere .= ' AND timestamp>=FROM_UNIXTIME(' . $startTime . ')';
                if ($endTime)
                    $qwhere .= ' AND timestamp<=FROM_UNIXTIME(' . $endTime . ')';
            }
            break;
        default:
            break;
    }

    $show_view_audits = null;
    if (!$show_view_audits) {
        $qwhere .= ' AND event_id !=' . db_input(Event::getIdByName('viewed'));
    }

    $pageNav = getPageNav($qwhere);
    $qs = null;
    $query = getQuery($qs, $objectId, $pageNav, $export, $type);
    $audits = db_query($query);
    if ($audits && ($num = db_num_rows($audits))) {
        $title = '';
        $showing = $pageNav->showing() . ' ' . $title;
    }
}
?>